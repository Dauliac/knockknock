webpackJsonp([1],{"0YIC":function(t,e){},An3Z:function(t,e){},FTBw:function(t,e){},GK12:function(t,e){},L6qK:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n=s("Dd8w"),r=s.n(n),i=(s("uMhA"),s("GK12"),s("QfY1"),{render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("nav",{staticClass:"navbar is-black"},[s("div",{staticClass:"container"},[t._m(0),t._v(" "),s("div",{staticClass:"navbar-menu",attrs:{id:"navbar"}},[s("div",{staticClass:"navbar-start"},t._l(t.links,function(e,a){return s("router-link",{key:a,staticClass:"navbar-item",attrs:{to:{name:e.path}}},[t._v(t._s(e.title))])}))]),t._v(" "),t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navbar-brand"},[e("span",{staticClass:"navbar-item"},[this._v("\n        KnockKnock\n      ")]),this._v(" "),e("div",{staticClass:"navbar-burger burger",attrs:{"data-target":"navbar"}},[e("span"),this._v(" "),e("span"),this._v(" "),e("span")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navbar-end"},[e("div",{staticClass:"navbar-item"},[e("div",{staticClass:"field is-grouped"},[e("p",{staticClass:"control"},[e("a",{staticClass:"button is-primary",attrs:{href:"https://github.com/jgthms/bulma/releases/download/0.7.1/bulma-0.7.1.zip"}},[e("span",{staticClass:"icon"},[e("i",{staticClass:"fas fa-download"})]),this._v(" "),e("span",[this._v("Deconnexion")])])])])])])}]});var o=s("VU/8")({name:"Navbar",data:function(){return{links:[{title:"Home",path:"Home"},{title:"Stream",path:"Stream"},{title:"Options",path:"Options"},{title:"Ringtones history",path:"Ringtones"}]}}},i,!1,function(t){s("gLQE")},"data-v-3c32a894",null).exports,c=s("NYxO"),u={name:"Login",data:function(){return{user:{mail:"",password:""},errors:this.$store.state.errors}},computed:r()({},Object(c.c)(["isAuthenticated"])),methods:r()({},Object(c.b)(["login"]))},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"hero is-dark is-fullheight"},[s("div",{staticClass:"hero-body"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"title is-1 has-text-centered"},[t._v("Login form")]),t._v(" "),s("form",[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Email")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.mail,expression:"user.mail"}],staticClass:"input",attrs:{type:"email",placeholder:"e.g. alexsmith@gmail.com"},domProps:{value:t.user.mail},on:{input:function(e){e.target.composing||t.$set(t.user,"mail",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Password")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"input",attrs:{type:"password",placeholder:"password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:function(e){t.login(t.user)}}},[t._v("Submit")])])]),t._v(" "),t._l(t.errors,function(e,a){return t.errors.length?s("div",{key:a},[s("div",{staticClass:"message is-danger"},[t._m(0,!0),t._v(" "),s("div",{staticClass:"message-body"},[t._v(t._s(e))])])]):t._e()})],2)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message-header"},[e("p",[this._v("Danger")]),this._v(" "),e("button",{staticClass:"delete",attrs:{"aria-label":"delete"}})])}]};var d={name:"App",components:{Navbar:o,Login:s("VU/8")(u,l,!1,function(t){s("vhLi")},"data-v-200ac95e",null).exports},computed:r()({},Object(c.c)(["isAuthenticated"])),created:function(){this.$store.dispatch("checkAuth")}},v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[this.isAuthenticated?e("div",[e("navbar"),this._v(" "),e("router-view")],1):e("login")],1)},staticRenderFns:[]};var p=s("VU/8")(d,v,!1,function(t){s("fgq2")},null,null).exports,m=s("/ocq"),h={name:"Home",data:function(){return{user:{mail:"",password:""},errors:this.$store.state.errors}},computed:r()({},Object(c.c)(["isAuthenticated"])),methods:r()({},Object(c.b)(["login"]))},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"container"},[e("h2",[this._v("Welcome "+this._s(this.user))])])},staticRenderFns:[]};var g=s("VU/8")(h,f,!1,function(t){s("An3Z")},"data-v-39104bf3",null).exports,_=s("Xxa5"),b=s.n(_),C=s("exGp"),w=s.n(C),k={name:"Ringtones",mounted:function(){var t=this;return w()(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getRingtones();case 2:case"end":return e.stop()}},e,t)}))()},methods:r()({},Object(c.b)(["updateRingtone","removeRingtone","getRingtones"])),computed:r()({},Object(c.c)(["ringtones"]))},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"columns is-multiline"},t._l(t.ringtones,function(e){return s("div",{key:e.id,staticClass:"column is-one-third"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-content"},[s("p",{staticClass:"title"},[s("a",{staticClass:"link",attrs:{href:e.replay_url}},[t._v("\n                "+t._s(e.id)+"\n              ")])]),t._v(" "),s("p",{staticClass:"subtitle"},[t._v("\n              "+t._s(e.timestamp)+"\n            ")])]),t._v(" "),s("footer",{staticClass:"card-footer"},[s("p",{staticClass:"card-footer-item"},[s("span",[t._v("\n                "+t._s(e.statuts)+"\n              ")])]),t._v(" "),s("p",{staticClass:"card-footer-item"},[s("a",{staticClass:"button is-danger",on:{click:function(s){t.removeRingtone(e.id)}}},[t._v("\n                Delete\n              ")])])])])])}))])])},staticRenderFns:[]};var A=s("VU/8")(k,x,!1,function(t){s("FTBw")},"data-v-0aee672f",null).exports,U={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"hero is-dark is-fullheight"},[e("div",{staticClass:"hero-body"},[e("div",{staticClass:"loader"})])])}]};var E={name:"Stream",components:{Loader:s("VU/8")({name:"Loader"},U,!1,function(t){s("0YIC")},"data-v-07ebc0e5",null).exports},data:function(){return{isActive:!1,errorMessage:""}},mounted:function(){var t=this;setInterval(function(){t.$store.dispatch("getRingtonePending").then(function(e){t.errorMessage=""}).catch(function(e){t.errorMessage=e.message,console.log(e.message)})},4500)},methods:r()({open:function(t){var e=this;return w()(b.a.mark(function s(){return b.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.status=3,s.next=3,e.updateRingtone(t);case 3:e.makeActive();case 4:case"end":return s.stop()}},s,e)}))()},close:function(t){var e=this;return w()(b.a.mark(function s(){return b.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.status=4,s.next=3,e.udpateRingtone(t);case 3:e.makeActive();case 4:case"end":return s.stop()}},s,e)}))()},makeActive:function(){this.isActive=!this.isActive}},Object(c.b)(["updateRingtone","getRingtonePending"])),computed:r()({},Object(c.c)(["ringtonePending"]))},R={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[!1===t.isActive?s("div",[s("loader"),t._v(" "),s("button",{on:{click:t.makeActive}},[t._v("click")])],1):s("div",[t.ringtonePending.length>0?s("div",{staticClass:"modal",class:{"is-active":t.isActive}},[s("div",{staticClass:"modal-background"}),t._v(" "),s("div",{staticClass:"modal-content"},[s("img",{attrs:{src:t.ringtonePending[0].replay_url}}),t._v(" "),s("button",{staticClass:"button is-success",on:{click:function(e){t.open(t.ringtonePending[0])}}},[t._v("Open")]),t._v(" "),s("button",{staticClass:"button is-danger",on:{click:function(e){t.close(t.ringtonePending[0])}}},[t._v("Close")])]),t._v(" "),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:t.makeActive}})]):t._e()])])},staticRenderFns:[]};var M=s("VU/8")(E,R,!1,function(t){s("L6qK")},"data-v-2d8f815c",null).exports,$={name:"UserTable",computed:r()({},Object(c.c)(["users"])),methods:{deleteUser:function(t){this.$emit("delete",t)},updateUser:function(t){this.$emit("update"),this.$store.commit("changeId",t)}}},P={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"table is-fullwidth is-hoverable"},[t._m(0),t._v(" "),s("tbody",t._l(t.users,function(e,a){return s("tr",{key:a},[s("th",[t._v(t._s(e.id))]),t._v(" "),s("th",[t._v(t._s(e.email))]),t._v(" "),s("th",[t._v(t._s(e.created))]),t._v(" "),s("th",[s("a",{staticClass:"button is-warning",on:{click:function(s){t.updateUser(e)}}},[t._v("Update")])]),t._v(" "),s("th",[s("a",{staticClass:"button is-danger",on:{click:function(s){t.deleteUser(e)}}},[t._v("Delete")])])])}))])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("ID")]),this._v(" "),e("th",[this._v("Email")]),this._v(" "),e("th",[this._v("Created at")]),this._v(" "),e("th"),this._v(" "),e("th")])])}]};var O={name:"Options",components:{UserTable:s("VU/8")($,P,!1,function(t){s("iYET")},"data-v-a70ca48e",null).exports},computed:r()({},Object(c.c)(["users"])),data:function(){return{telegramToken:"",isActive:!1,updateActiveModal:!1,user:{password:"",mail:""},isUsersLoaded:!1,errorMessage:""}},methods:r()({},Object(c.b)(["removeUser","postUser","updateUser"]),{toggleModal:function(){this.isActive=!this.isActive},updateModal:function(){this.updateActiveModal=!this.updateActiveModal},resetModel:function(){this.user.password="",this.user.mail=""},post:function(){var t=this;return w()(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.postUser(t.user);case 3:e.sent,t.toggleModal(),t.resetModel(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.resetModel();case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},update:function(){this.updateActiveModal=!this.updateActiveModal}}),mounted:function(){var t=this;0!==this.users.length?this.isUsersLoaded=!0:this.$store.dispatch("getUsers").then(function(){t.isUsersLoaded=!0}).catch(function(e){t.errorMessage=e.message})}},y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"container"},[s("h1",{staticClass:"title is-1 has-text-centered"},[t._v("Options")]),t._v(" "),s("label",[t._v("Telegram token :")]),t._v(" "),s("input",{staticClass:"input",attrs:{type:"text",placeholder:"Text input"}}),t._v(" "),s("h2",{staticClass:"title is-2 has-text-centered"},[t._v("User list")]),t._v(" "),s("a",{staticClass:"button is-success is-large is-pulled-right",on:{click:function(e){t.toggleModal()}}},[t._v("Create")]),t._v(" "),t.isUsersLoaded?s("user-table",{on:{delete:t.removeUser,update:t.updateModal}}):s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-12"},[s("h3",[t._v(t._s(t.errorMessage))])])]),t._v(" "),s("div",{staticClass:"modal",class:{"is-active":t.isActive}},[s("div",{staticClass:"modal-background"}),t._v(" "),s("div",{staticClass:"modal-content"},[s("form",[s("h3",{staticClass:"title is-3"},[t._v("Create user")]),t._v(" "),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Email")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.mail,expression:"user.mail"}],staticClass:"input",attrs:{type:"email",placeholder:"e.g. alexsmith@gmail.com"},domProps:{value:t.user.mail},on:{input:function(e){e.target.composing||t.$set(t.user,"mail",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Password")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"input",attrs:{type:"password",placeholder:"password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:function(e){t.post(t.user)}}},[t._v("Submit")])])])]),t._v(" "),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.toggleModal()}}})]),t._v(" "),s("div",{staticClass:"modal",class:{"is-active":t.updateActiveModal}},[s("div",{staticClass:"modal-background"}),t._v(" "),s("div",{staticClass:"modal-content"},[s("form",[s("h3",{staticClass:"title is-3"},[t._v("Update user")]),t._v(" "),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Email")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.mail,expression:"user.mail"}],staticClass:"input",attrs:{type:"email",placeholder:"e.g. alexsmith@gmail.com"},domProps:{value:t.user.mail},on:{input:function(e){e.target.composing||t.$set(t.user,"mail",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:function(e){t.updateUser()}}},[t._v("Submit")])])])]),t._v(" "),s("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){t.updateModal()}}})])],1)},staticRenderFns:[]};var N=s("VU/8")(O,y,!1,function(t){s("xZoB")},"data-v-ef04873c",null).exports;a.a.use(m.a);var L=new m.a({routes:[{path:"/",name:"Home",component:g},{path:"/ringtones",name:"Ringtones",component:A},{path:"/stream",name:"Stream",component:M},{path:"/options",name:"Options",component:N}]}),T=s("qUAD"),j=s.n(T),S=s("mtWM"),F=s.n(S),D={state:{users:[],userId:null},getters:{users:function(t){return t.users},userId:function(t){return t.userId}},mutations:{addUser:function(t,e){t.users.push(e)},loadUsers:function(t,e){t.users=e},popUser:function(t,e){t.users=t.users.filter(function(t){return t.id!=e})},changeId:function(t,e){t.userId=e.id}},actions:{getUsers:function(t){var e=this,s=t.commit;return w()(b.a.mark(function t(){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.a.get(j.a.url+"users");case 3:if(200!==(a=t.sent).status){t.next=7;break}return s("loadUsers",a.data),t.abrupt("return",a.data);case 7:t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Api down.");case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},postUser:function(t,e){var s=this,a=t.commit;return w()(b.a.mark(function t(){var n,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(n=new URLSearchParams).append("email",e.mail),n.append("password",e.password),""===e.password||""===e.mail){t.next=11;break}return t.next=7,F.a.post(j.a.url+"users/create",n);case 7:if(200!==(r=t.sent).status){t.next=11;break}return a("addUser",r.data),t.abrupt("return",r.data);case 11:t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(0),new Error("Api down.");case 16:case"end":return t.stop()}},t,s,[[0,13]])}))()},updateUser:function(t,e){var s=this,a=(t.commit,t.state);return w()(b.a.mark(function t(){var n,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new URLSearchParams).append("email",e.mail),t.next=5,F.a.put(j.a.url+"users/"+a.userId,n);case 5:if(200!==(r=t.sent).status){t.next=8;break}return t.abrupt("return",r.data);case 8:t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(0),new Error("Api down.");case 13:case"end":return t.stop()}},t,s,[[0,10]])}))()},removeUser:function(t,e){var s=this,a=t.commit;return w()(b.a.mark(function t(){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.a.delete(j.a.url+"users/"+e.id);case 3:if(200!==(n=t.sent).status){t.next=7;break}return a("popUser",e.id),t.abrupt("return",n.data);case 7:t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Api down.");case 12:case"end":return t.stop()}},t,s,[[0,9]])}))()}}},I={state:{ringtones:[],ringtonePending:[]},getters:{ringtones:function(t){return t.ringtones},ringtonePending:function(t){return t.ringtonePending}},mutations:{loadRingtones:function(t,e){t.ringtones=e},popRingtone:function(t,e){t.ringtones=t.ringtones.filter(function(t){return t.id!==e})},pendingRingtone:function(t,e){t.ringtonePending=e}},actions:{getRingtones:function(t){var e=this,s=t.commit;return w()(b.a.mark(function t(){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.a.get(j.a.url+"ringtones");case 3:if(200!==(a=t.sent).status){t.next=7;break}return s("loadRingtones",a.data),t.abrupt("return",a.data);case 7:t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Api down");case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},removeRingtone:function(t,e){var s=this,a=t.commit;return w()(b.a.mark(function t(){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.a.delete(j.a.url+"ringtones/"+e);case 3:if(200!==(n=t.sent).status){t.next=7;break}return a("popRingtone",e),t.abrupt("return",n.status);case 7:t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Api down");case 12:case"end":return t.stop()}},t,s,[[0,9]])}))()},updateRingtone:function(t,e){var s=this,a=(t.commit,t.state);return w()(b.a.mark(function t(){var n;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new URLSearchParams).append("status",e.status),t.next=5,F.a.put(j.a.url+"ringtones/"+e.id,n);case 5:200===t.sent.status&&a.ringtones.forEach(function(t){t.id===e.id&&(t.status=e.status)}),t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Api down");case 12:case"end":return t.stop()}},t,s,[[0,9]])}))()},getRingtonePending:function(t){var e=this,s=t.commit;return w()(b.a.mark(function t(){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.a.get(j.a.url+"ringtones/pending");case 2:return 200===(a=t.sent).status&&s("pendingRingtone",a.data),t.abrupt("return",a.data);case 5:case"end":return t.stop()}},t,e)}))()}}},H=s("Y4FN"),K=s.n(H);a.a.use(c.a);a.a.config.productionTip=!1,new a.a({el:"#app",router:L,store:function(){return new c.a.Store({modules:{usersStore:D,ringtonesStore:I},state:{isAuthenticated:!1,userMail:"",userToken:"",errors:[]},getters:{isAuthenticated:function(t){return t.isAuthenticated},userMail:function(t){return t.userMail},userToken:function(t){return t.userToken}},mutations:{TOKEN_CHANGED:function(t,e){t.userToken=e,t.isAuthenticated=!0}},actions:{checkAuth:function(t){var e=this,s=t.commit;return t.state,w()(b.a.mark(function t(){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,(a=K.a.get(j.a.tokenName))&&s("TOKEN_CHANGED",a),t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),new Error("Unauthenticated.");case 8:case"end":return t.stop()}},t,e,[[0,5]])}))()},login:function(t,e){var s=t.commit,a=t.state,n=new URLSearchParams;n.append("email",e.mail),n.append("password",e.password),F.a.post(j.a.url+"login",n).then(function(t){console.log(t),a.userMail=e.mail,K.a.set(j.a.tokenName,t.data.token),s("TOKEN_CHANGED",t.data.token)}).catch(function(t){console.log(t),a.errors.push(t.message),console.log(a.errors)})},deleteUser:function(t){F.a.delete(j.a.url+"users/"+t.id).then(function(t){return console.log(t)}).catch(function(t){return console.error(t)})}}})},components:{App:p},template:"<App/>"})},QfY1:function(t,e){},fgq2:function(t,e){},gLQE:function(t,e){},iYET:function(t,e){},qUAD:function(t,e){t.exports={url:"http://192.168.1.11/api/",tokenName:"_tkn"}},uMhA:function(t,e){},vhLi:function(t,e){},xZoB:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.40a2083a8cc2ac070518.js.map